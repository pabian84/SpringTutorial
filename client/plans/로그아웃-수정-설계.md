# 로그아웃 수정 설계

## 1. useDashboardData.ts - isAuthenticated 사용

**현재 (line 15-16, 32):**
```typescript
const { user, logout } = useAuth();
const myId = user?.id;
// ...
enabled: !!myId,
```

**수정:**
```typescript
const { user, isAuthenticated, logout } = useAuth();
const myId = user?.id;
// ...
enabled: isAuthenticated,  // ✅ isAuthenticated가 false면 요청 안 함
```

## 2. AuthProvider.tsx - logout 함수에 1초 대기

**현재 (line 84-123):**
```typescript
const logout = useCallback(async (reason?: string) => {
  forceDisconnect();
  queryClient.cancelQueries();
  
  if (reason) {
    showToast(reason, 'error');
  }

  setAuthState({
    authenticated: false,
    user: null,
    loading: false,
  });

  resetAuthCheck();

  // ... localStorage 정리 ...

  try {
    await userApi.logout(undefined);
  } catch (e) {
    devLog('[AuthProvider] 로그아웃 API 오류:', e);
  }

  navigate('/', { replace: true });

  devLog('[AuthProvider] 로그아웃 완료');
}, [navigate, forceDisconnect, queryClient]);
```

**수정:**
```typescript
const logout = useCallback(async (reason?: string) => {
  // 1. 먼저 state 변경 (Dashboard unmount됨)
  setAuthState({
    authenticated: false,
    user: null,
    loading: false,
  });

  // 2. 1초 대기 (React가 Dashboard unmount할 시간 주기)
  await new Promise(resolve => setTimeout(resolve, 1000));

  // 3. 이후 진행
  forceDisconnect();
  queryClient.cancelQueries();

  if (reason) {
    showToast(reason, 'error');
  }

  resetAuthCheck();

  // ... localStorage 정리 ...

  try {
    await userApi.logout(undefined);
  } catch (e) {
    devLog('[AuthProvider] 로그아웃 API 오류:', e);
  }

  navigate('/', { replace: true });

  devLog('[AuthProvider] 로그아웃 완료');
}, [navigate, forceDisconnect, queryClient]);
```

## 요약

| 파일 | 수정 내용 |
|------|----------|
| `useDashboardData.ts` | `isAuthenticated`를 import하고 `enabled: isAuthenticated`로 변경 |
| `AuthProvider.tsx` | logout 함수 시작 부분에 1초 대기 추가 |
